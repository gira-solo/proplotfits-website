---
title: "Today's Picks"
subtitle: "January 4, 2026"
date: last-modified
format:
  html:
    code-fold: true
    code-summary: "Show code"
---
```{r setup, include=FALSE}
library(tidyverse)
library(knitr)
library(gt)

# Load today's predictions
predictions <- read_rds("C:/Users/peter/Documents/broscience/sports/ncaa_mbb/predictions/predictions_20260104.rds")

# Helper function to format picks table
format_picks_table <- function(data) {
  data %>%
    gt() %>%
    tab_style(
      style = cell_text(weight = "bold"),
      locations = cells_column_labels()
    ) %>%
    tab_options(
      table.font.size = px(14),
      heading.title.font.size = px(18),
      heading.subtitle.font.size = px(14)
    ) %>%
    cols_align(
      align = "center",
      columns = everything()
    ) %>%
    cols_align(
      align = "left",
      columns = c(Matchup)  # Changed from home_team_name, away_team_name
    )
}
```

::: {.callout-important}
## Beta Disclaimer
These predictions are generated by machine learning models currently in beta testing. Past performance does not guarantee future results. Please bet responsibly.
:::

---

## üéØ Top 10 Spread Value Bets

Our model identifies games where our predicted margin differs significantly from Vegas spreads.

**Edge Threshold:** 3+ points
```{r spread-picks}
#| echo: false
#| warning: false

spread_picks <- predictions %>%
  filter(has_spread_value) %>%
  arrange(desc(spread_edge)) %>%
  head(10) %>%
  mutate(
    matchup = glue::glue("{away_team_name} @ {home_team_name}"),
    our_line = round(pred_margin, 1),
    vegas_line = round(vegas_spread, 1),
    edge = round(spread_edge, 1),
    confidence = round(pred_win_prob * 100, 1)
  ) %>%
  select(
    Matchup = matchup,
    `Our Prediction` = our_line,
    `Vegas Spread` = vegas_line,
    `Edge` = edge,
    `Win Prob %` = confidence,
    `Recommended Bet` = spread_pick
  )

spread_picks %>%
  format_picks_table() %>%
  tab_header(
    title = "Spread Value Bets",
    subtitle = glue::glue("Top 10 of {sum(predictions$has_spread_value, na.rm = TRUE)} total opportunities")
  ) %>%
  data_color(
    columns = Edge,
    palette = "RdYlGn",
    domain = c(3, max(spread_picks$Edge))
  )
```

### How to Read This Table

- **Our Prediction**: Home team margin (positive = home win, negative = away win)
- **Vegas Spread**: Current average across DraftKings, FanDuel, BetMGM
- **Edge**: Absolute difference between our prediction and Vegas (higher = more value)
- **Win Prob %**: Our model's confidence in home team victory
- **Recommended Bet**: Which side and line to take

---

## üìä Top 10 Total Value Bets

Games where our predicted total points differ significantly from Vegas totals.

**Edge Threshold:** 5+ points
```{r total-picks}
#| echo: false
#| warning: false

total_picks <- predictions %>%
  filter(has_total_value) %>%
  arrange(desc(total_edge)) %>%
  head(10) %>%
  mutate(
    matchup = glue::glue("{away_team_name} @ {home_team_name}"),
    our_total = round(pred_total, 1),
    vegas_line = round(vegas_total, 1),
    edge = round(total_edge, 1),
    direction = ifelse(pred_total > vegas_total, "OVER", "UNDER")
  ) %>%
  select(
    Matchup = matchup,
    `Our Total` = our_total,
    `Vegas Total` = vegas_line,
    `Edge` = edge,
    `Direction` = direction,
    `Recommended Bet` = total_pick
  )

total_picks %>%
  format_picks_table() %>%
  tab_header(
    title = "Total Value Bets",
    subtitle = glue::glue("Top 10 of {sum(predictions$has_total_value, na.rm = TRUE)} total opportunities")
  ) %>%
  data_color(
    columns = Edge,
    palette = "RdYlGn",
    domain = c(5, max(total_picks$Edge))
  )
```

### How to Read This Table

- **Our Total**: Predicted combined score for both teams
- **Vegas Total**: Current average O/U line
- **Edge**: Difference in predicted points (higher = more value)
- **Direction**: Whether to bet OVER or UNDER
- **Recommended Bet**: Specific line to target

---

## üèÜ Top 10 High-Confidence Plays

Games where our model has the highest win probability predictions.

**Confidence Threshold:** Based on win probability model
```{r confidence-picks}
#| echo: false
#| warning: false

confidence_picks <- predictions %>%
  filter(!is.na(vegas_spread)) %>%
  mutate(
    # Confidence is either high win prob for home or high win prob for away
    confidence_value = pmax(pred_win_prob, 1 - pred_win_prob),
    favorite = ifelse(pred_win_prob > 0.5, home_team_name, away_team_name)
  ) %>%
  arrange(desc(confidence_value)) %>%
  head(10) %>%
  mutate(
    matchup = glue::glue("{away_team_name} @ {home_team_name}"),
    our_line = round(pred_margin, 1),
    vegas_line = round(vegas_spread, 1),
    confidence = round(confidence_value * 100, 1),
    edge = round(spread_edge, 1)
  ) %>%
  select(
    Matchup = matchup,
    `Favorite` = favorite,
    `Win Prob %` = confidence,
    `Our Spread` = our_line,
    `Vegas Spread` = vegas_line,
    `Edge` = edge
  )

confidence_picks %>%
  format_picks_table() %>%
  tab_header(
    title = "High Confidence Plays",
    subtitle = "Model's strongest win probability predictions"
  ) %>%
  data_color(
    columns = `Win Prob %`,
    palette = "Blues",
    domain = c(50, 100)
  )
```

### How to Read This Table

- **Favorite**: Team our model projects to win
- **Win Prob %**: Model confidence (50% = toss-up, 100% = certain)
- **Our Spread**: Predicted margin of victory
- **Vegas Spread**: Market's predicted margin
- **Edge**: Additional value if spread edges align

---

## üì• Download Full Report

Want all today's predictions?
```{r download-button}
#| echo: false
#| results: asis

# Create CSV download
csv_file <- "C:/Users/peter/Documents/broscience/sports/ncaa_mbb/predictions/predictions_20260104.csv"
if(file.exists(csv_file)) {
  cat(glue::glue('[Download Complete Predictions (CSV)]({csv_file}){{.btn .btn-primary}}\n\n'))
} else {
  cat("*CSV file not yet available*\n\n")
}
```

**Includes:**

- All 48 games scheduled for January 4, 2026
- Predicted spreads, totals, and win probabilities
- Vegas odds from 3 sportsbooks (DraftKings, FanDuel, BetMGM)
- Calculated edges and value indicators
- Team statistics and rolling metrics
---

## üìà Model Performance

::: {.callout-note}
## Beta Testing Phase
We're tracking model performance starting January 2026. Historical backtesting shows promise, but live results will be reported transparently as they come in.

Check back weekly for updated performance metrics.
:::

---

## ‚ö†Ô∏è Responsible Betting

- **Set a budget** and stick to it
- **Never chase losses**
- **Bet for entertainment**, not income
- **Use multiple sportsbooks** to find best lines
- **Consider unit sizing** based on edge/confidence

**Resources:**

- [National Council on Problem Gambling](https://www.ncpgambling.org/)
- [Gamblers Anonymous](https://www.gamblersanonymous.org/)

---

*Predictions updated: `r Sys.time()` EST*

*Next update: Daily at 9:00 AM EST*