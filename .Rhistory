getwd()
install.packages("gt")
library(gt)
install.packages("gt")
install.packages("gt")
library(gt)
library(ggplot2)
library(dplyr)
library(hoopR)
library(janitor)
schedule <-
load_mbb_schedule(seasons = 2026) %>%
clean_names()
box_scores <-
load_mbb_team_box(seasons = 2026) %>%
clean_names()
# Filter to just Kansas & Miami
hawks <-
box_scores %>%
filter(team_display_name %in% c("Kansas Jayhawks", "Miami (OH) RedHawks"))
load_mbb_schedule(seasons = 2026)
load_mbb_schedule(seasons = 2026) %>%
clean_names()
options(scipent = 999)
options(scipen = 999)
library(ggplot2)
library(dplyr)
library(hoopR)
library(janitor)
schedule <-
load_mbb_schedule(seasons = 2026) %>%
clean_names()
box_scores <-
load_mbb_team_box(seasons = 2026) %>%
clean_names()
# Filter to just Kansas & Miami
hawks <-
box_scores %>%
filter(team_display_name %in% c("Kansas Jayhawks", "Miami (OH) RedHawks"))
# Quick look at what we have
glimpse(hawks)
hawks
hawks[,1:2]
hawks[1:2,]
hawks[1:2,] |> print()
hawks[1:2,] |> str()
library(ggplot2)
library(dplyr)
library(hoopR)
library(janitor)
schedule <-
load_mbb_schedule(seasons = 2026) %>%
clean_names()
box_scores <-
load_mbb_team_box(seasons = 2026) %>%
clean_names()
# Filter to just Kansas & Miami
hawks <-
box_scores %>%
filter(team_display_name %in% c("Kansas Jayhawks", "Miami (OH) RedHawks"))
# Quick look at what we have
str(hawks[1:2,])
four_factors <-
hawks %>%
mutate(
# Effective Field Goal % (weights three-pointers appropriately)
efg_pct = (field_goals_made + 0.5 * three_point_field_goals_made) /
field_goals_attempted,
# Turnover % (turnovers per 100 possessions)
tov_pct = turnovers /
(field_goals_attempted + 0.44 * free_throws_attempted + turnovers),
# Offensive Rebound % (offensive rebounds captured)
orb_pct = offensive_rebounds /
(offensive_rebounds + defensive_rebounds),
# Free Throw Rate (free throw attempts per field goal attempt)
ft_rate = free_throws_made / field_goals_attempted
) %>%
select(team_display_name, game_date, team_score, opponent_team_score,
efg_pct, tov_pct, orb_pct, ft_rate)
# Show the first few games
head(four_factors, 10)
four_factors <-
hawks %>%
mutate(
# Effective Field Goal % (weights three-pointers appropriately)
efg_pct = (field_goals_made + 0.5 * three_point_field_goals_made) /
field_goals_attempted,
# Turnover % (turnovers per 100 possessions)
tov_pct = turnovers /
(field_goals_attempted + 0.44 * free_throws_attempted + turnovers),
# Offensive Rebound % (offensive rebounds captured)
orb_pct = offensive_rebounds /
(offensive_rebounds + defensive_rebounds),
# Free Throw Rate (free throw attempts per field goal attempt)
ft_rate = free_throws_made / field_goals_attempted
) %>%
select(team_display_name, game_date, team_score, opponent_team_score,
efg_pct, tov_pct, orb_pct, ft_rate)
# Show the first few games
head(four_factors, 10) |> knitr::kable()
?knitr::kable
season_averages <-
four_factors %>%
group_by(team_display_name) %>%
summarise(
games = n(),
avg_efg = mean(efg_pct, na.rm = TRUE),
avg_tov = mean(tov_pct, na.rm = TRUE),
avg_orb = mean(orb_pct, na.rm = TRUE),
avg_ftr = mean(ft_rate, na.rm = TRUE),
.groups = "drop"
)
season_averages %>%
knitr::kable(
digits = 3,
col.names = c("Team", "Games", "eFG%", "TOV%", "ORB%", "FTR"),
caption = "Season Averages: Four Factors"
)
season_averages <-
four_factors %>%
group_by(team_display_name) %>%
summarise(
games = n(),
avg_efg = mean(efg_pct, na.rm = TRUE),
avg_tov = mean(tov_pct, na.rm = TRUE),
avg_orb = mean(orb_pct, na.rm = TRUE),
avg_ftr = mean(ft_rate, na.rm = TRUE),
.groups = "drop"
)
library(kableExtra)
season_averages %>%
knitr::kable(
digits = 3,
col.names = c("Team", "Games", "eFG%", "TOV%", "ORB%", "FTR"),
caption = "Season Averages: Four Factors",
format = "html",
escape = FALSE
) %>%
kable_styling(bootstrap_options = c("striped", "hover")) %>%
# Highlight max eFG% (higher is better)
column_spec(3,
background = ifelse(season_averages$avg_efg == max(season_averages$avg_efg),
"#d4edda", "white")) %>%
# Highlight min TOV% (lower is better)
column_spec(4,
background = ifelse(season_averages$avg_tov == min(season_averages$avg_tov),
"#d4edda", "white")) %>%
# Highlight max ORB% (higher is better)
column_spec(5,
background = ifelse(season_averages$avg_orb == max(season_averages$avg_orb),
"#d4edda", "white")) %>%
# Highlight max FTR (higher is better)
column_spec(6,
background = ifelse(season_averages$avg_ftr == max(season_averages$avg_ftr),
"#d4edda", "white"))
#| echo: false
library(tidyverse)
library(knitr)
# Comparison table from our analysis
comparison <- read_csv("fsu_clem_stats.csv")
kable(comparison,
digits = 3,
caption = "Last 5 Games Statistical Comparison")
comparison
#| echo: false
library(tidyverse)
library(knitr)
# Comparison table from our analysis
comparison <- read_csv("fsu_clem_stats.csv")
kableExtra::kable(comparison,
digits = 3,
caption = "Last 5 Games Statistical Comparison")
kableExtra::kable(comparison,
digits = 3,
caption = "Last 5 Games Statistical Comparison")
library(gt)
gt::gt(comparison)
#| echo: false
library(tidyverse)
library(gt)
# Comparison table from our analysis
comparison <- read_csv("fsu_clem_stats.csv")
comparison |>
gt() |>
tab_header(
title = 'Last 5 Games Statistical Comparison',
subtitle = 'Florida State Seminoles @ Clemson Tigers'
) |>
fmt_number(
columns = c(Home, Away),
decimals = 1
) |>
tab_style(
sytle = cell_fill(color = '#782F40', alpha = 0.3),
locations = cells_body(columns, everything(), rows = Advantage == 'Florida State Seminoles')
)
#| echo: false
library(tidyverse)
library(gt)
# Comparison table from our analysis
comparison <- read_csv("fsu_clem_stats.csv")
comparison |>
gt() |>
tab_header(
title = 'Last 5 Games Statistical Comparison',
subtitle = 'Florida State Seminoles @ Clemson Tigers'
) |>
fmt_number(
columns = c(Home, Away),
decimals = 1
) |>
tab_style(
style = cell_fill(color = '#782F40', alpha = 0.3),
locations = cells_body(columns, everything(), rows = Advantage == 'Florida State Seminoles')
)
#| echo: false
library(tidyverse)
library(gt)
# Comparison table from our analysis
comparison <- read_csv("fsu_clem_stats.csv")
comparison |>
gt() |>
tab_header(
title = 'Last 5 Games Statistical Comparison',
subtitle = 'Florida State Seminoles @ Clemson Tigers'
) |>
fmt_number(
columns = c(Home, Away),
decimals = 1
) |>
tab_style(
style = cell_fill(color = '#782F40', alpha = 0.3),
locations = cells_body(columns = everything(), rows = Advantage == 'Florida State Seminoles')
)
comparison |>
gt() |>
tab_header(
title = 'Last 5 Games Statistical Comparison',
subtitle = 'Florida State Seminoles @ Clemson Tigers'
) |>
fmt_number(
columns = c(Home, Away),
decimals = 1
) |>
tab_style(
style = cell_fill(color = '#782F40', alpha = 0.3),
locations = cells_body(columns = everything(), rows = Advantage == 'Florida State Seminoles')
)
comparison |>
gt() |>
tab_header(
title = 'Last 5 Games Statistical Comparison',
subtitle = 'Florida State Seminoles @ Clemson Tigers'
) |>
fmt_number(
columns = c(Home, Away),
decimals = 1
) |>
tab_style(
style = cell_fill(color = '#782F40', alpha = 0.3),
locations = cells_body(
columns = everything(),
rows = Advantage == 'Florida State Seminoles')
) |>
tab_style(
style = cell_fill(color = '#F56600', alpha = 0.3),
locations = cells_body(
columns = everything(),
rows = Advantage == 'Clemson Tigers')
) |>
tab_style(
style = cell_text(weight = 'bold'),
locations = cells_body(
columns = Advantage
)
) |>
tab_source_note(
source_note = "Source: hoopR | ProPlotFits Analysis"
) |>
opt_stylize(style = 6, color = 'grey')
comparison |>
gt() |>
tab_header(
title = 'Last 5 Games Statistical Comparison',
subtitle = 'Florida State Seminoles @ Clemson Tigers'
) |>
fmt_number(
columns = c(Home, Away),
decimals = 1
) |>
tab_style(
style = cell_fill(color = '#782F40', alpha = 0.3),
locations = cells_body(
columns = everything(),
rows = Advantage == 'Florida State Seminoles')
) |>
tab_style(
style = cell_fill(color = '#F56600', alpha = 0.3),
locations = cells_body(
columns = everything(),
rows = Advantage == 'Clemson Tigers')
) |>
tab_style(
style = cell_text(weight = 'bold'),
locations = cells_body(
columns = Advantage
)
) |>
tab_source_note(
source_note = "Source: hoopR | ProPlotFits Analysis"
) |>
opt_stylize(style = 6, color = 'gray')
box_scores
season_averages
#| echo: false
predictions <- tibble(
Model = c("Win Probability", "Predicted Margin", "Predicted Total"),
Prediction = c("Clemson 50.6%", "Clemson by 0.3", "139.5 points"),
`Model MAE` = c("69%", "9.5 points", "13.5 points")
)
predictions |>
gt() |>
tab_caption("Model Predictions for Florida State @ Clemson")
#| echo:false
vegas_comparison <- tibble(
Metric = c("Spread", "Total"),
`Our Model` = c("Clem -0.3", "139.5"),
Vegas = c("Clem -8.5", "143.5"),
Gap = c("8.2 points", "4 points"),
`% of MAE` = c("86.3%", "29.6%"),
Confidence = c("Very High", "Low")
)
predictions |>
gt() |>
tab_caption("DraftKings Lines vs Model Outputs")
#| echo:false
vegas_comparison <- tibble(
Metric = c("Spread", "Total"),
`Our Model` = c("Clem -0.3", "139.5"),
Vegas = c("Clem -8.5", "143.5"),
Gap = c("8.2 points", "4 points"),
`% of MAE` = c("86.3%", "29.6%"),
Confidence = c("Very High", "Low")
)
vegas_comparison |>
gt() |>
tab_caption("DraftKings Lines vs Model Outputs")
